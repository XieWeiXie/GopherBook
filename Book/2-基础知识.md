
本节主题介绍 Go 语言的基本语法知识，Go 是一门编程语言，是语言，创造者会规定一系列的约定，这些约定称之为语法，熟悉语法，相当于熟悉了工具，这样我们就能更好的利用工具完成自己的任务，或者创造些好玩的项目，编程改变世界。


暂且先抛开 Go 本身的语法，我们从自己“创造编程语言”的角度来思考，需要考虑哪些方面？需要哪些知识呢？

> 最重要的是定义一套规则

那规则应该包含些什么内容呢？

- 变量、常量：定义好需要操作的对象，和万事万物一样，有了相应的名字，才能对应好，知道是谁
- 数据类型：定义好操作对象的类型
- 基本数据集合：比如相同数据类型的集合、比如不同数据类型又如何集合
- 流程控制：日常生活中都会越到选择，程序也一样，需要判断、选择
- 相同功能的工具提炼：日常生活中，比如我们会使用各种各样的工具实现相应的功能，代码中如何实现
- 错误处理：代码像人一样，也会犯错，需要知道面对错误如何处理
- 结构体：这块知识，可以看着一个组织，组织由各种角色的人完成特定的任务；不同组织由不同的人，完成不同的任务
- ...


可以看出，现在的高级语言，基本是对真实世界的抽象。从这一点出发，理解代码，一定程度上需要理解真实世界，有时某些概念不是很清楚，第一有可能是翻译不好，一手资料来自国外，经翻译后，拿捏的不准确。第二有可能是对真实的世界理解的不准确。当然，代码最终还是跑在机器上，多多少少还是和真实的世界不能完成对应，但至少给了我们一个思考的方向。

上文我们组织的这些内容，其实称之为编程语言的基本语言特性，每门语言都有这些内容，不管你学Python，Java，JavaScript 或者本书的主题 Go。明白这些内容之后，我们学习 Go 语言，甚至学习其他编程语言，都可以事半功倍。


下面的内容，我们从两个角度学习 Go 的基本语法：

- 编程风格
- 实际内容

所有的内容，都朝着一个目标，即编写易于理解的代码。


### 变量

任何语言都一套自己的命名规则，比如 Python 建议使用带下划线的这种，比如 `number_list`，而 Go 中建议使用驼峰式，比如 `numberList`。

当然变量命名还遵循其他的规则，比如变量由下划线、字母、数字组成、首位不能是数字，且不能使用内置的关键字。虽然有这些规定，但在 Go 里面，建议只使用字母，其实也很简单，使用相应的英文单词即可。

#### 命名

对于简单系统，命名是个很简单的事，但系统复杂之后，命名是个特别重要的事，所以这里建议，命名还是需要遵守一些规范。这样使得代码的可读性增强，对于后期的维护、修改，具有很大的帮助。

- 使用具体的命名

换个意思说，即避免泛化的命名，比如 temp，i，j，k 之类的，它们有一定的适用场景，但绝大多少情况下，建议使用具体的命名。

比如：变量是一个数组，表示一群学生的学号，那么命名 `studentIDList` 是不是更好？

再比如：变量表示判断一个值是否是学生的名字，那么命名 `isStudentName` 是不是更好？


- 不宜过长、不宜过短

看上去是个似有似无的建议，这里给个中肯的建议，变量命名以 2～3 个单词的长度为宜

- 加上后缀或者前缀

这种场景，适合变量有区间的这种操作，比如 `numberMax`，`numberMin`，`timeLast`，`timeBefore`




#### 声明与赋值


以下是变量的声明示例：

```
var numberOne int
numberOne = 1

numberTwo := 1

var isNumber bool
isNumber = true

canFly := false


var numberMax float64
numberMax = 1.23

numberMin := 3.1415

```

变量的声明使用 Go 内置的关键字 var， 可以显式的声明变量的类型（比如：numberOne、isNumber、numberMax），也可以声明时即赋值（比如：numberTwo、canFly、numberMin），具体的类型自动识别。

那哪种合适呢？建议使用显式的命名方式，这样阅读的可读性更好。阅读的过程就知道数据的类型。为什么？有时候赋值来自于函数的返回值，这时候，你不阅读函数的定义，不太明白变量的类型。但好的命名，使读者知道操作对象的类型，且知道操作对象的具体含义。

比如：

```

numberList := FetchNumberList()

```

#### 多变量声明与赋值

```
var strOne, strTwo, strThree string
strOne, strTwo, strThree = "1", "2", "3"

numOne, numTwo, numThree := 1, 2, 4 

```

`strOne, strTwo, strThree` 变量显式指定类型 `string`， `numOne, numTwo, numThree` 变量隐式指定类型 `int`。

赋值操作需要确保右边的值的类型和左边一致。

#### 变量的作用域

上文讲了变量的命名，关于变量还存在一个比较重要的内容：变量的作用域，即变量的生效的范围。
- 局部作用域
- 全局作用域

局部作用域，表示变量的生效只在局部内有效，即比如函数内，而且可以和全局的变量名字相同，这个时候优先使用局部作用域内的值。

全局作用域，表示变量的生效在全局内有效，声明在函数外部。

```
var exampleNumber int = 1156143589
var exampleString string = "WuXiaoShen"

func varFunc() {
	var exampleNumber = 987654321
	fmt.Println(exampleNumber)
}

func varGlobalFunc() {
	fmt.Println(exampleNumber)
}


func main(){
    varFunc()
    fmt.Println(exampleNumber, exampleString)
    varGlobalFunc()
}

>>
987654321
1156143589 WuXiaoShen
1156143589
```

示例中，`exampleNumber, exampleString` 表示的是全局变量，同一个 package 内任何函数都可以调用，同时 `varFunc` 函数内又存在 `exampleNumber` 局部变量，这个时候，局部变量的优先级大于全局变量，所以先输出 `98754321`。




### 常量

变量是运行过程中值会变动的量，所以变量不适合做用做全局作用域，因为运行过程中会改变，如果项目复杂了，多次使用到这个值，在运行过程中发生了变动，追踪起来不是很容易。

所以，避免使用变量的作用域作为全局变量。

相对于变量，存在一种不变动的量，称之为常量。常量的值因为不会在运行过程中变动，所以适合用于全局范围。

```
func main(){
    
    const Name string = "xieWei"
	const Age int = 25
	const Info string = "ShangHai"
	fmt.Println(Name, Age, Info)
	
    
}

>>
xieWei 25 ShangHai
```

如果你尝试改变常量，编译报错:

```
const Name string = "xieWei"

Name = "Go"

```

编译报错：`cannot assign to Name`

### 基本数据类型


上文我们基本上是在操作数值型和字符串型数据，当然 Go 含有丰富的数据类型，满足日常的开发的需求，这些都不是 Go 特有的，各种编程语言都有丰富的数据类型。

那除了数值型和字符串型数据类型，还存在哪些基本数据类型呢？

- 数值型

数值型区分整型、浮点型，相应的又区分带符号的和不带符号的。数值型根据长度的不同又区分好多种。

```
int、uint、int8、uint8、float32、float64、complex64、complex128、rune
```

- 字符串和字符型

字符串是种非常基本的数据类型，在编写代码过程中经常会遇到了。
```
string、rune
```

- 布尔类型

布尔类型表示是否、真假类型这类。取值有 true 和 false 两种。
```
bool
```

- 数组类型

表示一组相同数据类型的数据集合。具有固定的长度
```
# array

var number = [3]int{1,2,3}
```
- 切片类型

也表示一组相同数据的数据的集合，但是长度可以扩充，不固定。
```
# slice

var number = []int{1,2,3,4}
```

- 结构体类型

表示一组不同数据类型的值的集合。基本定义和 C 语言内的结构体很像，但是用法和 C 语言中的差别很大。
```
# struct
type Name struct{
    
}
```
- 函数类型

函数也可以表示一种类型。
```
# function

var name = func() {}
```

- interface

Go 语言中用 interface 表示任意类型，也可以用来表示一系列方法的集合。
```
# interface

type Name interface{
    Print() string
    Do(int) int
}

```

- map

这种带键值对的形式称之为 map 类型。
```
# map[key]value

var name = map[string]string
```

- channel

Go 语言原生支持并发，数据间使用 channel 管道来通信。
```
# channel

var name = make(chan string)
```


示例：

```

package main

import "fmt"

func main() {

	var (
		number        int     = 1 // int
		numberFloat   float32 = 1.23 // float32
		stringExample string  = "hello world" // string
		char                  = `A` // rune
		isChar        bool    = false // bool

		numberList = [3]int{1, 2, 3} // array
		stringList = [...]string{"212", "234", "345"} //array

		numberSlice = numberList[1:] //slice
		stringSlice = stringList[1:]// slice
	)

	type Info struct {
		Name       string
		Age        int
		University string
		Habit      map[string]string
	} // struct

	habits := make(map[string]string) // map
	habits["One"] = "Go"
	habits["Two"] = "Python"

	var info = Info{
		Name:       "xieWei",
		Age:        23,
		University: "ShangHai",
		Habit:      habits,
	} // struct

	var helloWorld func() // function
	helloWorld = func() {
		fmt.Println("Hello world")
	}

	var noName interface{} // interface
	noName = 1
	noName = "12"
	noName = 1.23

	helloWorld()
	fmt.Println(number,
		numberFloat,
		stringExample,
		char,
		isChar,
		numberList,
		stringList,
		numberSlice,
		stringSlice,
		info,
		noName)

}

>>
Hello world
1 1.23 hello world A false [1 2 3] [212 234 345] [2 3] [234 345] {xieWei 23 ShangHai map[One:Go Two:Python]} 1.23

```

正是编程语言支持如此多的数据类型，让开发者可以专注于业务的实现上。



#### 类型转换

Go 虽然是强数据类型的编程语言，如此多的数据类型，相互之间可不可以进行转换？

答案是可以，也不是所有数据类型都可以直接相互转换，可以选择自己实现，也可以使用内置的库 strconv, 可以很便利的完成：字符串和数值型、布尔类型之间的类型转换。


示例：

```
func main(){
    
    var price = 100
	fmt.Println(strconv.Itoa(price)) // 数值型转字符串型

	var isPrice bool = false
	fmt.Println(strconv.FormatBool(isPrice)) // 布尔类型转字符串型
}

```
#### 定义自己的类型

Go 支持用户自己定义类型，不过这些类型，都是根据基本数据的类型派生出来，意思是自定义的类型，是由内置数据类型组合而成。

```
func main(){
    
    
    type XieWei int
	type Zhihu string
	type WeChat Zhihu
	
    var xieWeiName XieWei
	var xieWeiZhihu Zhihu
	var xieWeiWechat WeChat
	
	xieWeiName = 12
	xieWeiZhihu = "Learn golang"
	xieWeiWechat = "Step by Step"

	fmt.Println(xieWeiName, xieWeiZhihu, xieWeiWechat)
}

>>
12 Learn golang Step by Step
```

这种方式相当于给原生的数据类型重命名：即 XieWei(int)，Zhihu(string)，WeChat(Zhihu(string))

使用方法：使用关键字 type 即可定义用户自己的类型。


### 函数

生活中，我们会使用各种的工具完成特定的任务，同样编程中把完成特定任务的代码片段的集合称之为函数。

首先，我们可以看下“函数”在数学中的定义：

> 给定一个数集 A，假设其中的元素为 x。现对 A 中的元素 x 施加对应法则 f，记作 f（x），得到另一数集 B。假设 B中的元素为 y。则 y 与 x 之间的等量关系可以用 y=f（x）表示。

关键是：给定一个或者多个输入参数，得出一个或者多个输出结果。

这里要注意两个关键：

- 输入参数
- 返回值

函数是结构化编程的最小模块单元，将一些代码片段集合起来，完成特定的任务，便于复用、代码组织。

在 Go 中如何定义函数？函数有哪些内容？

示例：

```
package main

import "fmt"


func PrintHello() {
	fmt.Println("Hello world")
}

var PrintName = func() { // 匿名函数
	fmt.Println("Hello Name")
}

func main() {
	PrintHello()
	PrintName()
}

>>
Hello world
Hello Name
```

1. 以关键字 func 开头，定义一个函数；可以传入参数，也可以不传入参数，可以有返回值，也可以没有返回值
2. 不以 func 开头，也可以定义一个函数，称之为匿名函数，赋给一个变量，调用变量即可使用匿名函数，匿名函数多用于简单的处理逻辑
3. 调用需要带上 `()`
4. 返回值使用关键字 return 
5. 函数名称大写：可导出；否则小写表示私有，不可导出(导出的判断：不同包组织之间是否可以调用或者引用)

#### 带参数和返回值

前面讲过函数的两个重要的关键点是：输入和返回值。

```
func SumNumber(numberOne int, numberTWo int) int {
	return numberOne + numberTWo
}

func main() {
    sunAdd := SumNumber(1,2)
}

>> 
3
```

- numberOne，numberTwo 表示参数，且是 int 类型
- 返回值有一个，表示 int 类型

#### 带参数命名返回值

示例：

```
func NameResult(numberOne, numberTwo int) (result int) {
	result = numberOne + numberTwo
	return
}

func main(){
    sumResult := NameResult(10, 20)
	fmt.Println(sumResult)
}

>> 
30

```

- 连续的相同类型的输入参数，可以只声明一个类型，比如只显式的申明了 int 类型
- 可以给返回值命名，比如 result 
- 返回值命名，return 不用直接带变量返回。直接 return 即可
- 调用需要带 `()`

#### 多返回值

示例：

```go
func MultiResult(numberOne int, numberTwo int) (int, string) {
	sum := numberOne + numberTwo
	return sum, strconv.Itoa(sum)
}

func main(){
    
    fmt.Println(MultiResult(100, 200))

}

>>
300 300
```

- Go 是强类型的编程语言，输入参数，返回值都需要指定的数据类型
- 多返回值需要带 `()`，比如（int, string） 
- 调用的顺序和定义的一致，有几个输入，就传入几个输入，有几个输出，就接收几个输出

#### 匿名函数

简而言之，匿名函数指定是函数没有指定名称的函数，一般的处理场景是：处理的逻辑顺序比较简单的场景。

示例：

```go
var anonymousFuncTimes = func(numberOne int) int {
	return numberOne * 10

}

func main(){
    fmt.Println(anonymousFuncTimes(100))
}

>>
1000
```

- 匿名函数适合简单的业务场景
- 匿名函数通常赋给一个变量，调用该变量即可实现匿名函数的调用
- 其他输入参数和返回值的处理和正常定义的函数一致


### 流程控制

流程控制其实是个面对选择如何操作的问题。现实世界中，虽然我们面对选择的决定总是会犹豫不决，但是在代码层面，并不是如此，代码层面，满足什么样的条件，就完成什么样的操作。从这个层面来说，代码比人更“痛快”。

#### if 判断

if 关键词在绝大所数编程语言中都有，并不是 Go 独有的。用法也相同。if 满足条件，执行什么操作。

```go
package main

import "fmt"

func HelloGolang(language string) {

	if language == "Go" {
		fmt.Println("Hello " + language)
	}

}

func main() {
	HelloGolang("Go")

}

>> 
Hello Go
```

- if 后面接判断的条件，只要保持表达式为真即可， 比如 language == "Go"
- 满足条件的操作使用 `{}` 包裹住
- 不满足条件不会触发对应分支的操作

#### if ... else

这个相当于两个相对的选择，满足条件执行 if 内的操作，否则执行 else 内的内容。

示例：

```
func HelloGo(language string) {
	if language == "Go" {
		fmt.Println("Hello " + language)
	} else {
		fmt.Println("Hello ?" + language)
	}
}

func main(){
    
    HelloGo("Go")
	HelloGo("Python")
}
>>
Hello Go
Hello ? Python
```

- if ... else 成对出现，if 执行条件判断，不满足的自动执行 else 内操作
- 这种情况下，只要两种选择，要么“是” 则触发 if， 要么“不是”则触发 else

#### if ... else if ... else

这个相当于多个选择（大于等于3个选择），满足 if 条件，执行 if 内操作，否则继续判断，如果都不满足，最终执行 else 内的操作。

示例：

```
func HelloLanguage(language string) {

	if language == "Go" {
		fmt.Println("Go Google")
	} else if language == "Python" {
		fmt.Println("import this")
	} else {
		fmt.Println("？？ " + language)
	}
}

func main(){
    
    HelloLanguage("Go")
	HelloLanguage("Python")
	HelloLanguage("Java")
}
>>
Go Google
import this
？？ Java
```

- 除 else 表示最后一种场景不需要限制条件之外，其他都需要带上判断条件



#### switch ... case


switch ... case 也可以用来表示多种选择。

虽然 if ... else if ... else 已经可以表示多重选择，但为什么还需要使用 switch ... case 呢，当然是因为使用场景不同了， switch 一方面可以用来多种选择分支，一方面常用来类型断言。

示例：

```
func useSwitch(str string) {
	switch str {
	case "A":
		fmt.Println("Score >=", 90)
	case "B":
		fmt.Println("80 <= Score < 90")
	case "C":
		fmt.Println("70 <= Score < 80")
	case "D":
		fmt.Println("60 <= Score < 70")
	case "E":
		fmt.Println("50 <= Score < 60")
	default:
		fmt.Println("Score < 50")
	}
}

func mian(){
    useSwitch("A")
	useSwitch("B")
	useSwitch("D")
	useSwitch("dad")
}
>>
Score >= 90
80 <= Score < 90
60 <= Score < 70
Score < 50

```

- switch 后接变量和  case 的条件进行匹配
- 每一个 case 表示一个匹配条件
- 如果都没有匹配，还存在一个默认的匹配选项，默认的匹配选项执行的是所有不匹配case条件的条件
- 一个 case 可以接收多个条件，用逗号隔开，比如：case "A","B", "C":
- 建议 case 条件按照一定的顺序，比如“从小到大”，或者“从大到小”




#### for 循环

日常生活，其实我们会执行一些重复性的操作。比如日复一日的坐相同的班次去上班，诸如此类的重复性的操作。

在编程内，使用 for 来表示一些执行相同动作的操作。

示例：

```
func SayGo(number int) {

	for i := 0; i < number; i++ {
		fmt.Println("Hello Golang")
	}
}

func main(){
    SayGo(3)
}

>>
Hello Golang
Hello Golang
Hello Golang

```

- for 接收一串表达式，表达式有初始值（i :=0）、终止条件（i <= number）、迭代条件 （i++）
- 满足条件的会被重复执行多次（number）

另外 for 也可以不接收表达式，这个时候相当于 while , 但 Go 语言内没有 while 这个关键字。


for 还可以执行遍历操作。


示例：

```
func useForRange(names []string) {
	for index, name := range names {
		fmt.Println(index, name)
	}
}

func main(){
    useForRange([]string{"Zhao", "Qian", "Sun", "Li", "Zhou", "Wang"})

}
>>
0 Zhao
1 Qian
2 Sun
3 Li
4 Zhou
5 Wang

```

- for ... range 配合使用，一般用来遍历数组、切片、或者map
- index 表示偏移量，从 0 开始


#### 结构体

结构体在 Go 语言内，可以用来表示不同数据类型的数据集合，是用户自定义的类型，可以用来完成复杂的结构定义。

**声明、初始化**

```
package main

import "fmt"

type Info struct {
	Name       string
	Age        int
	University string
}

func main() {

	var info Info
	info = Info{
		Name:       "XieWei",
		Age:        20,
		University: "ShangHai",
	}

	var infoTwo = new(Info)
	infoTwo.Name = "XieWei"
	infoTwo.Age = 22
	infoTwo.University = "BeiJing"

	fmt.Println(info, infoTwo, *infoTwo)
}

>>
{XieWei 20 ShangHai} &{XieWei 22 BeiJing} {XieWei 22 BeiJing}
```

- 结构体是多种数据类型的数据的集合，是用户自定义的类型
- 多种数据类型的数据称之为结构体的属性，属性区分可访问（公有）和不可访问（私有），如何区分？依据是属性的首字母是否大写，大写：公有，外部库可访问；小写：私有，外部库不可访问
- 属性的赋值或者访问，使用 `.` 的形式
- 初始化有两种方法，直接声明，或者使用 new , 会分配一个地址

**方法**

方法是与对象实例绑定的特殊函数。是面向对象的基本概念，用来进行对象的某些操作，比如获取值，改变值等其他操作，所以结构体能用来完成面向对象的“类”的概念。

示例：

```
type MyInt struct {
    Number int
}

func (m MyInt) SayHello() {
	fmt.Println("Hello World")
}

func (m *MyInt) SetNumber(other int) {
    m.Number = other
}

func (m MyInt) SayNumber(){
    fmt.Println(m.Number)
}

func main(){
    var my MyInt
    my.Number = 1
	my.SayHello()
	my.SayNumber()
	my.SetNumber(100)
	my.SayNumber()
}
>>
Hello World
Hello World
1
100
```

- 上文给定了 MyInt 类型指定了方法 SayHello，SayNumber，SetNumber
- 方法的使用也使用 `.` 的形式，比如 m.SayHello(), m.SayNumber()
- 需要修改类型的属性，需要传入指针，比如 func(m *MyInt)


**组合**

面向对象中存在类的继承，那继承如何在 Go 里面实现呢？

答案：组合，即结构体嵌套结构体，实现组合，既而实现类似“继承”概念。


示例：

```
type ViewName struct {
	Name string
	ViewOther
}

func (v ViewName) SayName() {
	fmt.Println(v.Name)
}

type ViewOther struct {
	Value string
}

func (v ViewOther) SayValue() {
	fmt.Println(v.Value)
}

func main(){
    
    var viewName ViewName
	viewName.Name = "xieWei"
	viewName.Value = "value"
	viewName.SayName()
	viewName.SayValue()
}
>>
xieWei
value
```

- 上文通过组合的方式，ViewName 组合 ViewOther，使得 ViewName 字段拥有 Value 字段和 ViewOther 的方法 SayValue
- 这种方式称之为组合，达到 “继承” 的目的


### 接口

接口是对其他类型行为的抽象和概括，是一组方法的集合，接口指定了对象的行为，接口是 Go 语言中的非常重要的数据类型。

示例：

```
package main

import "fmt"

type Controller interface {
	SayHello()
	SayNumber(int)
	SayHi()
}

type DefaultController struct {
}

func (d DefaultController) SayHello() {
	fmt.Println("Hello world")
}

func (d DefaultController) SayNumber(number int) {
	fmt.Println(fmt.Sprintf("%d", number))
}

func (d DefaultController) SayHi() {
	fmt.Println("Say Hi")
}

func main() {

	var d DefaultController
	var c Controller
	c = d

	c.SayHello()
	c.SayNumber(123)
	c.SayHi()
}
>>
Hello world
123
Say Hi

```

- 定义一个接口：Controller， 定义三个方法：SayHello, SayNumber, SayHi
- 定义一个结构体：DefaultController，实现三个方法：SayHello, SayNumber，SayHi
- 这样称之为：DefaultController 实现了接口 Controller

#### 内置的接口

```
// 内置接口
type error interface {
	Error() string
}
```


```
// 实现内置接口

type ErrorCode struct {
	Code    int
	Message string
}

func (e ErrorCode) Error() string {
	return fmt.Sprintf("Code: %d, Message: %s", e.Code, e.Message)
}


func SayError() error {
	var e ErrorCode
	e.Code = 400
	e.Message = "http status code"
	return e
}

func main(){
    
    SayError()
}

```

- 内置存在 error 接口，定义了 Error 方法
- 定义了自己的结构体类型 ErrorCode，有 Error 方法：相同的类型、数量的输入输出
- ErrorCode 实现了 error 接口


从上文可以看出，一个结构体只要实现了接口定义的方法（输入参数类型、个数一致，返回值类型、个数一致），那么结构体就实现的这个接口。




### 总结


本节介绍了 Go 的基本知识，包括基本的数据类型：数值型、字符串、数组、切片，结构体等，介绍了些基本的编程知识，包括变量、函数、流程控制、循坏操作等。

这些基本的知识，能够让大家快速的掌握 Go 的知识，这样便于开发者，掌握这些知识，尽快的投入到编程开发的过程中。


