
Go 是 Google 的 Robert Griesemer，Rob Pike 及 Ken Thompson 开发的一种静态强类型、编译型、并发型，并具有垃圾回收功能的编程语言，是一款比较年轻的编程语言，背后语言开发团队阵容强大，有丰富的生态系统。使得 Go 作为一款新兴的编程语言，拥有越来越多的使用者。

本章描述 Go 的语言特性，在了解基础语言特性的基础上编写第一个程序，包括：环境的搭建、环境变量的设置、开发工具的推荐、第一个程序的编写运行、Go 命令行工具和工程目录的结构等。



## 1. 语言特性

### 1.1 优雅的语法

如果你接触过其他编程语言，上手 Go 非常简单，语法类似于 C，同时又结合其他编程语言的优点。优雅的语法，使得初学者，很容易掌握，这对于想学习编程语言的人来说，实在是太好不过了，有些编程语言语法晦涩，大多数人望而却步，更别说打造编程语言的生态圈。当然一门编程语言能够在市场上占据一定的份额，说明，一定存在着其他的应用场景，使用的人多了，生态也就慢慢完善起来了。



### 1.2 天然的并发

Go 语言的 goroutine,使得并发编程非常的简便，因为是天然的支持并发，不像其他编程语言，需要借助第三方库间接的实现，比如 Python 需要借助 threading、mutilprocess等实现。它用类协程的方式来处理并发单元，在运行层面做了更深的优化处理，使得使用起来，超级的简便。只需要使用一个关键字 go 即可实现。

### 1.3 静态链接

编写完 Go 项目工程后，只需要编译成任意操作系统的可执行文件，在任何平台即可执行，无需任何依赖。这种不依赖库，存在着极大的好处。试想下，假如需要在多套环境下运行程序，项目功能编译后，还存在诸多的依赖，那么开发者在搞定这些依赖就需要花销很多的时间，这对开发者不够友好，没有把时间关注在业务处理上。

### 1.4 生态圈

一个生态圈丰富不丰富，一看标准库是否支持，再一个看社区活跃不活跃。Go 有着丰富的标准库，功能完善、质量可靠的编程库为开发者提供了极大的便利，不借助其他第三方库即可完成诸多的任务，对开发者而言，省时省力。

另外 Go 也有着丰富的工具链，比如内置的 Go 命令行工具，编译、运行、测试、性能测试、代码结构化等功能都可以使用 Go 命令行工具实现。

既然有标准库，那么对第三方库的管理对编程语言来说便是一个重要的话题：Go 生态的第三方包管理工具，官方也没有一个具体的推荐，市面存在诸多款包管理工具：Govendor、Glide和 Dep 等。最新发布的 1.11 版本之后，支持module 来进行项目包管理。

总体来讲，Go 的整个生态圈丰富，比如明星产品 Docker, nsq，etcd  等微服务领域有着广泛的使用。

相信在未来，Go 的发展会越来越好。

## 2. 环境的搭建


既然要使用 Go 来进行编写代码，首先第一件事便是开发环境的搭建。俗话说的好：工欲擅其事，必先利其器。

- 下载符合操作系统的安装包: 选择当前最新版本 1.13.4 (https://golang.org/dl/)
- Windows
- Linux
- Mac
- 设置环境变量
- 验证配置信息
- 选择合适的集成开发环境(IDE)


### 2.1 下载符合操作系统的安装包

这个和绝大多数软件的安装一致，选择符合操作系统的安装包、二进制文件、源码，下载对应的即可。官网提供了各种个样的版本，选择最新的版本即可(写本书时刻最新版本是 1.13.4)。

和绝大多软件一样安装，设置安装目录等。

### 2.2.1 设置环境变量

> 支持 GOPATH 版本的设置

环境变量是操作系统在运行时需要需要参数的设置。

和 Go 相关的几个环境变量为：

- GOPATH: 项目工程目录
- GOROOT： Go 源代码的安装目录
- GOBIN： 编译 Go 程序的可执行文件的存放目录


以 Linux 为例，安装操作步骤如下：

解压至某目录：存放Go源码目录

```
tar -C /usr/local -xzf go$VERSION.$OS-$ARCH.tar.gz
```

> VERSION 版本，OS 操作系统，ARCH 架构

环境变量设置：

```
export GOROOT=/user/local/go
export GOPATH=/Users/xiewei/go
export GOBIN=$GOPATH/bin
export PATH=$PATH:/usr/local/go/bin
```

再重申一遍，初学者容易混淆 GOROOT和GOPATH，GOROOT 是 Go 源代码的存放目录，比如你现在源代码，解压至某目录，就将这个目录设置为GOROOT；GOPATH 是项目的工程目录，具体的值由使用者确定，比如我在 /Users/xiewei/ 目录下创建 一个文件件 go, 用来存放用 go 编写的代码，那么GOPATH 就设置为/Users/xiewei/go

安装和配置完，在任意终端下执行 go env 便可以看到整个和 go 相关的环境变量。

```
GOARCH="amd64"
GOBIN="/Users/xiewei/go/bin"
GOCACHE="/Users/xiewei/Library/Caches/go-build"
GOEXE=""
GOFLAGS=""
GOHOSTARCH="amd64"
GOHOSTOS="darwin"
GOOS="darwin"
GOPATH="/Users/xiewei/go"
GOPROXY=""
GORACE=""
GOROOT="/usr/local/go"
GOTMPDIR=""
GOTOOLDIR="/usr/local/go/pkg/tool/darwin_amd64"
GCCGO="gccgo"
CC="clang"
CXX="clang++"
CGO_ENABLED="1"
GOMOD=""
CGO_CFLAGS="-g -O2"
CGO_CPPFLAGS=""
CGO_CXXFLAGS="-g -O2"
CGO_FFLAGS="-g -O2"
CGO_LDFLAGS="-g -O2"
PKG_CONFIG="pkg-config"
GOGCCFLAGS="-fPIC -m6

```

查看 go 的版本：go version

```
go version go1.13.4 darwin/amd64
```


在支持 GOPATH 设置的条件下，平常开发者创建的工程都在 $GOPATH/src 目录下，下载的第三方库也在这个目录下：

```
>> ls -l $GOPATH/src

github.com
myproject1
myproject2
...

```

其中 github.com 存储的第三方库的目录。myproject1 等是开发者自身的项目。这样依赖于 GOPATH 的环境变量的设置被社区在新版本中逐渐摒弃，转而推出 `go mod` 版本管理，这种版本管理方式不依赖于 GOPATH。


### 2.2.2 设置环境变量

> 无需 GOPATH 的支持

只需设置：GOROOT 即 go 安装目录。

```
export GOROOT=/user/local/go
export PATH=$PATH:/usr/local/go/bin 
```

这种方式开发者可以在任意目录下创建文件夹作为工程目录。

比如：

```
mkdir go-anything
```
此时只需要执行 `go mod init` 即可。

```
go mod init
```

会自动创建 `go.mod, go.sum` 作为版本管理的文件。需要使用第三方库，只需 `go get` 会自动的更改  `go.mod, go.sum` 文件，推荐使用这种方式作为版本管理的方式。


```
>> go version
go version go1.13.4 darwin/amd64
```



### 2.3 编辑器的选择

市面有各种各样的编辑器，编辑器的选择没有什么特定的规律，哪个顺手用哪个，挑选一款友好的编辑器，可以节省时间成本。

- GoLand：JetBrains 旗下优秀的IDE：https://www.jetbrains.com/
- LiteIDE：http://liteide.org/cn/
- Visual Studio Code：https://code.visualstudio.com


如果你喜欢颜值高点，自动补全，高亮，集成 git，有丰富的插件系统的编辑器，那么可以使用 Goland, JetBrains旗下针对 Go 专门开发的编辑器。旗下各种各样的编程语言都有对应的编辑器，学会这一款，其他的编程 IDE 使用功能一致，不会增加学习负担。

LiteIDE 是一款简单，开源，跨平台的 Go IDE。

vscode 是一款轻量强大的代码编辑器，支持各种编程语言，当然需要以安装插件的方式支持，因为免费，且好用，在程序员届非常受欢迎。

总的标准：颜值高，好用，接受付费，可以选择 Goland; 轻量，可以选择vscode。


### 2.4 第一个程序


环境安装好，环境变量设置好，编辑器也选择好，那么可以开始写代码。

```
package main

import "fmt"

func main() {
var name string
name = "Golang"
fmt.Println(fmt.Sprintf("Hello World , Hello %s", name))
}


```


```
go run main.go
>> Hello World , Hello Golang
```

上文是一个最简单的程序

- package 表示包名
- import 导入内置 fmt 的库
- main 主函数入口
- 打印出 Hello World, Hello Golang


Golang 中，一般的程序的结构就是这样：

- 包名
- 导入依赖包
- 编写处理函数

## 3. Go 命令行 和 项目结构


### 3.1 支持 GOPATH 的工作目录

Go 的工作区的目录结构如下：即 GOPATH 目录下

```
bin
pkg
src
```

- bin: 编译后的程序存储目录
- pkg: 编译时生成的对象文件
- src: 库文件

这是约定，Go 设计者这么约定，按照这样的方式组织即可。个人的项目可以在 src 目录下创建新文件即可，第三方库则存放在 src 的 github.com目录的下。

### 3.2 不支持 GOPATH 的工作目录

设置 GOROOT, 任意目录下创建工程即可。




安装好 go, 内置命令行工具。常用的有这些：

- go build
- go run 
- go fmt
- go test
- go get
- go version
- go env


**go build**

将程序编译成可执行文件；

**go run**

先编译成可执行文件，再运行文件；

**go fmt**

格式化代码，比如换行，缩进等；

**go test**

运行测试用来的命令；

**go get**

获取第三方库命令；常用下载第三方库的命令

**go version**

查看当前操作系统的 go 的版本信息；

**go env**

查看当前操作系统的和 go 相关的环境变量的值；



## 4. 总结

本节粗略的探讨了 go 的一些特性，包括并发、自动垃圾回收、生态圈等；再演示了整个环境的搭建，编写了第一个程序，让读者大致了解下 Go 的基本概念，还大致探讨了 go 内置的命令行工具的简易用法。

